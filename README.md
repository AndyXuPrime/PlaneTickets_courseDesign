# âœˆï¸ PlaneTickets_courseDesign | æœºç¥¨é¢„è®¢ç³»ç»Ÿ

<div align="center">
  
  ![Spring Boot](https://img.shields.io/badge/Spring%20Boot-3.3.0-brightgreen?style=for-the-badge&logo=springboot)
  ![Vue](https://img.shields.io/badge/Vue.js-2.6-4FC08D?style=for-the-badge&logo=vue.js)
  ![Element UI](https://img.shields.io/badge/Element%20UI-2.15-409EFF?style=for-the-badge&logo=element)
  ![MySQL](https://img.shields.io/badge/MySQL-8.0-4479A1?style=for-the-badge&logo=mysql)
  ![Java](https://img.shields.io/badge/Java-17-ED8B00?style=for-the-badge&logo=openjdk)

  <p>ğŸ“ åŸºäº Spring Boot + Vue çš„å‰åç«¯åˆ†ç¦»æœºç¥¨é¢„è®¢ç³»ç»Ÿè¯¾ç¨‹è®¾è®¡</p>

</div>

<p align="center">
  <a href="#-é¡¹ç›®æ¦‚è¿°">ğŸ“– é¡¹ç›®æ¦‚è¿°</a> â€¢
  <a href="#-åŠŸèƒ½ç‰¹æ€§">âœ¨ åŠŸèƒ½ç‰¹æ€§</a> â€¢
  <a href="#-æŠ€æœ¯æ ˆ">ğŸ› ï¸ æŠ€æœ¯æ ˆ</a> â€¢
  <a href="#-å¿«é€Ÿå¼€å§‹">ğŸš€ å¿«é€Ÿå¼€å§‹</a> â€¢
  <a href="#-æ•°æ®åº“è®¾è®¡">ğŸ’¾ æ•°æ®åº“è®¾è®¡</a> â€¢
  <a href="#-å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ">â“ å¸¸è§é—®é¢˜</a>
</p>

---

## ğŸ“– é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªåŸºäº **Spring Boot 3** å’Œ **Vue 2** å¼€å‘çš„å‰åç«¯åˆ†ç¦»æœºç¥¨é¢„è®¢ç³»ç»Ÿã€‚ç³»ç»Ÿæ¨¡æ‹Ÿäº†çœŸå®çš„èˆªç­æŸ¥è¯¢ã€æœºç¥¨é¢„è®¢ã€è®¢å•ç®¡ç†åŠé€€ç¥¨æµç¨‹ï¼Œå¹¶åŒ…å«ä¸€ä¸ªç®¡ç†å‘˜åå°ç”¨äºç»´æŠ¤èˆªç­ä¿¡æ¯å’ŒæŸ¥çœ‹é”€å”®ç»Ÿè®¡ã€‚

é¡¹ç›®æ—¨åœ¨è§£å†³è¯¾ç¨‹è®¾è®¡ä¸­å¸¸è§çš„æŠ€æœ¯éš¾ç‚¹ï¼Œå¦‚ JWT èº«ä»½è®¤è¯ã€å¤æ‚ SQL æŸ¥è¯¢ã€å‰åç«¯è·¨åŸŸäº¤äº’ä»¥åŠ VS Code ç¯å¢ƒä¸‹çš„ Java å¼€å‘é…ç½®ã€‚

### ğŸ”— ä»“åº“åœ°å€
- **åç«¯ (Backend):** [backend](https://github.com/AndyXuPrime/PlaneTickets_courseDesign/tree/main/backend)
- **å‰ç«¯ (Frontend):** [frontend](https://github.com/AndyXuPrime/PlaneTickets_courseDesign/tree/main/frontend)

---

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### ğŸ§‘â€âœˆï¸ ç”¨æˆ·ç«¯
- **èˆªç­æŸ¥è¯¢**: æ”¯æŒæŒ‰å‡ºå‘åœ°ã€ç›®çš„åœ°ã€æ—¥æœŸã€èˆªç©ºå…¬å¸è¿›è¡Œæ¨¡ç³Š/ç²¾ç¡®æŸ¥è¯¢ã€‚
- **æœºç¥¨é¢„è®¢**: å®æ—¶æ˜¾ç¤ºä½™ç¥¨ï¼Œæ”¯æŒç»æµèˆ±/å•†åŠ¡èˆ±é€‰æ‹©ï¼Œé˜²æ­¢è¶…å–ã€‚
- **è®¢å•ç®¡ç†**: æŸ¥çœ‹å†å²è®¢å•ï¼Œæ”¯æŒæŸ¥çœ‹è®¢å•è¯¦æƒ…ã€‚
- **åœ¨çº¿é€€ç¥¨**: ç”¨æˆ·å¯å¯¹æœªä½¿ç”¨çš„æœºç¥¨è¿›è¡Œé€€ç¥¨æ“ä½œã€‚
- **ä¸ªäººä¸­å¿ƒ**: ç®¡ç†ä¸ªäººä¿¡æ¯åŠä¼šå‘˜ç­‰çº§ï¼ˆæ™®é€š/é“¶å¡/é‡‘å¡/ç™½é‡‘ï¼‰ã€‚

### ğŸ‘¨â€ğŸ’» ç®¡ç†å‘˜ç«¯
- **èˆªç­ç®¡ç†**: èˆªç­çš„å¢åˆ æ”¹æŸ¥ (CRUD)ã€‚
- **æ•°æ®ç»Ÿè®¡**: 
  - ğŸ“Š çƒ­é—¨èˆªçº¿åˆ†æ
  - ğŸ“ˆ é”€å”®é¢ç»Ÿè®¡
  - ğŸ‘¥ ç”¨æˆ·ç”»åƒåˆ†æï¼ˆå¹´é¾„/æ€§åˆ«åˆ†å¸ƒï¼‰
- **åŠ¨æ€å®šä»·**: æ ¹æ®å‰©ä½™åº§ä½æ•°å’Œæ—¶é—´åŠ¨æ€è°ƒæ•´ç¥¨ä»·ç­–ç•¥ã€‚

---

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

| æ¨¡å— | æŠ€æœ¯/å·¥å…· | è¯´æ˜ |
| :--- | :--- | :--- |
| **åç«¯** | Spring Boot 3.3.0 | æ ¸å¿ƒæ¡†æ¶ |
| | Spring Security + JWT | è®¤è¯ä¸æˆæƒ (æ— çŠ¶æ€) |
| | Spring Data JPA |æŒä¹…å±‚æ¡†æ¶ (Hibernate) |
| | Lombok | ç®€åŒ– Java ä»£ç  (éœ€æ³¨æ„ IDE æ’ä»¶) |
| **å‰ç«¯** | Vue 2.6 | å‰ç«¯æ¡†æ¶ |
| | Element UI | UI ç»„ä»¶åº“ |
| | Axios | HTTP è¯·æ±‚åº“ |
| **æ•°æ®åº“** | MySQL 8.0 | å…³ç³»å‹æ•°æ®åº“ |
| **å¼€å‘ç¯å¢ƒ** | VS Code / IDEA | å¼€å‘å·¥å…· |
| | Maven 3.x | åç«¯æ„å»ºå·¥å…· |
| | npm / Node.js | å‰ç«¯åŒ…ç®¡ç† |

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡
- **JDK**: 17+ (Spring Boot 3 å¿…éœ€)
- **Node.js**: å»ºè®® v14 æˆ– v16
- **MySQL**: 8.0+

### 2. æ•°æ®åº“é…ç½®
1. åˆ›å»ºæ•°æ®åº“ `plane_ticket_db`ã€‚
2. æ‰§è¡Œä¸‹æ–‡ [æ•°æ®åº“è®¾è®¡](#-æ•°æ®åº“è®¾è®¡) ä¸­çš„ SQL å»ºè¡¨è¯­å¥ã€‚
3. ä¿®æ”¹åç«¯é…ç½®æ–‡ä»¶ `src/main/resources/application.properties`ï¼š
   ```properties
   spring.datasource.username=ä½ çš„ç”¨æˆ·åä¸€èˆ¬ä¸ºroot
   spring.datasource.password=ä½ çš„çœŸå®å¯†ç 
   ```

### 3. åç«¯å¯åŠ¨ (Backend)
> **âš ï¸ æ³¨æ„ï¼š** å¦‚æœä½¿ç”¨ VS Code å¼€å‘ï¼Œå¯èƒ½ä¼šé‡åˆ° Lombok æ³¨è§£ä¸ç”Ÿæ•ˆçš„é—®é¢˜ã€‚

```bash
cd backend
# æ¨èä½¿ç”¨å‘½ä»¤è¡Œå¯åŠ¨ï¼Œé¿å… IDE ç¼“å­˜é—®é¢˜
mvn clean spring-boot:run
```
å¯åŠ¨æˆåŠŸåï¼Œåç«¯æœåŠ¡è¿è¡Œåœ¨ `http://localhost:8080`ã€‚

### 4. å‰ç«¯å¯åŠ¨ (Frontend)
> **âš ï¸ æ³¨æ„ï¼š** æœ¬é¡¹ç›®è§£å†³äº† Element UI ä¾èµ–çš„ `async-validator` ä¸ Babel 7 çš„å†²çªé—®é¢˜ã€‚

```bash
cd frontend
# 1. å®‰è£…ä¾èµ–
npm install

# 2. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run serve
```
å¯åŠ¨æˆåŠŸåï¼Œè®¿é—® `http://localhost:8081` (å¦‚æœ 8080 è¢«åç«¯å ç”¨)ã€‚

---

## ğŸ’¾ æ•°æ®åº“è®¾è®¡

ä»¥ä¸‹æ˜¯æ ¸å¿ƒä¸šåŠ¡è¡¨çš„ Schema è®¾è®¡ã€‚

### Table: airlines (èˆªç©ºå…¬å¸)
```sql
TABLE `airlines` (
  `airline_code` char(2) NOT NULL,
  `airline_name` varchar(50) NOT NULL,
  `country` varchar(30) DEFAULT 'ä¸­å›½',
  `contact_phone` varchar(20) DEFAULT NULL,
  `website` varchar(100) DEFAULT NULL,
  PRIMARY KEY (`airline_code`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci
```

### Table: customers (ä¹˜å®¢/ç”¨æˆ·)
```sql
 TABLE `customers` (
  `customer_id` int NOT NULL AUTO_INCREMENT COMMENT 'é¡¾å®¢ID',
  `name` varchar(50) NOT NULL COMMENT 'å§“å',
  `gender` enum('ç”·','å¥³') DEFAULT 'ç”·' COMMENT 'æ€§åˆ«',
  `id_card` varchar(18) DEFAULT NULL,
  `phone` varchar(20) NOT NULL COMMENT 'æ‰‹æœºå·',
  `email` varchar(50) DEFAULT NULL COMMENT 'ç”µå­é‚®ç®±',
  `membership_level` enum('æ™®é€š','é“¶å¡','é‡‘å¡','ç™½é‡‘') DEFAULT 'æ™®é€š' COMMENT 'ä¼šå‘˜ç­‰çº§',
  `password` varchar(30) NOT NULL DEFAULT '1234567890',
  PRIMARY KEY (`customer_id`),
  UNIQUE KEY `uniq_customers_phone` (`phone`) COMMENT 'æ‰‹æœºå·å”¯ä¸€ç´¢å¼•',
  UNIQUE KEY `uk_id_card` (`id_card`),
  KEY `idx_customers_name` (`name`) COMMENT 'æŒ‰å§“åæŸ¥è¯¢',
  CONSTRAINT `chk_valid_email` CHECK (((`email` is null) or regexp_like(`email`,_utf8mb4'^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$'))),
  CONSTRAINT `chk_valid_phone` CHECK (regexp_like(`phone`,_utf8mb4'^1[3-9]\\d{9}$'))
) ENGINE=InnoDB AUTO_INCREMENT=14 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='é¡¾å®¢ä¿¡æ¯è¡¨'
```

### Table: flights (èˆªç­)
```sql
TABLE `flights` (
  `flight_number` varchar(6) NOT NULL COMMENT 'èˆªç­å·(å¦‚CA1886)',
  `airline_code` char(2) NOT NULL COMMENT 'èˆªç©ºå…¬å¸ä»£ç ',
  `departure_airport` varchar(50) NOT NULL COMMENT 'èµ·é£æœºåœº',
  `arrival_airport` varchar(50) NOT NULL COMMENT 'åˆ°è¾¾æœºåœº',
  `departure_time` time NOT NULL COMMENT 'èµ·é£æ—¶é—´',
  `arrival_time` time NOT NULL COMMENT 'åˆ°è¾¾æ—¶é—´',
  `aircraft_model` varchar(20) NOT NULL COMMENT 'é£æœºå‹å·',
  `business_seats` smallint NOT NULL COMMENT 'å•†åŠ¡èˆ±åº§ä½æ•°',
  `economy_seats` smallint NOT NULL COMMENT 'ç»æµèˆ±åº§ä½æ•°',
  `base_price` decimal(10,2) NOT NULL COMMENT 'åŸºç¡€ä»·æ ¼',
  PRIMARY KEY (`flight_number`),
  KEY `idx_flights_airline` (`airline_code`) COMMENT 'æŒ‰èˆªç©ºå…¬å¸æŸ¥è¯¢',
  KEY `idx_flights_departure` (`departure_airport`) COMMENT 'æŒ‰èµ·é£æœºåœºæŸ¥è¯¢',
  KEY `idx_flights_arrival` (`arrival_airport`) COMMENT 'æŒ‰åˆ°è¾¾æœºåœºæŸ¥è¯¢',
  CONSTRAINT `fk_flights_airline` FOREIGN KEY (`airline_code`) REFERENCES `airlines` (`airline_code`) ON DELETE CASCADE,
  CONSTRAINT `chk_seats_positive` CHECK (((`business_seats` >= 0) and (`economy_seats` >= 0))),
  CONSTRAINT `chk_valid_price` CHECK ((`base_price` > 0)),
  CONSTRAINT `chk_valid_times` CHECK ((`arrival_time` > `departure_time`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='èˆªç­åŸºæœ¬ä¿¡æ¯è¡¨'
```

### Table: tickets (æœºç¥¨/è®¢å•)
```sql
 TABLE `tickets` (
  `ticket_id` bigint NOT NULL AUTO_INCREMENT COMMENT 'æœºç¥¨ID',
  `flight_number` varchar(6) NOT NULL COMMENT 'èˆªç­å·',
  `flight_date` date NOT NULL COMMENT 'èˆªç­æ—¥æœŸ',
  `customer_id` int NOT NULL COMMENT 'é¡¾å®¢ID',
  `class` enum('ç»æµèˆ±','å•†åŠ¡èˆ±') NOT NULL COMMENT 'èˆ±ä½ç­‰çº§',
  `price` decimal(10,2) NOT NULL COMMENT 'å®é™…ä»·æ ¼',
  `status` enum('å·²é¢„è®¢','å·²æ”¯ä»˜','å·²å–æ¶ˆ','å·²ä½¿ç”¨') DEFAULT 'å·²é¢„è®¢' COMMENT 'æœºç¥¨çŠ¶æ€',
  `booking_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'é¢„è®¢æ—¶é—´',
  `payment_time` timestamp NULL DEFAULT NULL COMMENT 'æ”¯ä»˜æ—¶é—´',
  PRIMARY KEY (`ticket_id`),
  KEY `fk_ticket_customer` (`customer_id`),
  KEY `idx_tickets_flight_date` (`flight_date`) COMMENT 'æŒ‰èˆªç­æ—¥æœŸæŸ¥è¯¢',
  KEY `idx_tickets_status` (`status`) COMMENT 'æŒ‰æœºç¥¨çŠ¶æ€æŸ¥è¯¢',
  KEY `idx_tickets_flight_instance` (`flight_number`,`flight_date`) COMMENT 'è”åˆæŸ¥è¯¢èˆªç­å®ä¾‹',
  CONSTRAINT `fk_ticket_customer` FOREIGN KEY (`customer_id`) REFERENCES `customers` (`customer_id`) ON DELETE CASCADE,
  CONSTRAINT `fk_ticket_flight` FOREIGN KEY (`flight_number`) REFERENCES `flights` (`flight_number`) ON DELETE CASCADE,
  CONSTRAINT `chk_booking_before_flight` CHECK ((`booking_time` < (`flight_date` + interval 1 day))),
  CONSTRAINT `chk_valid_payment_time` CHECK ((((`status` in (_utf8mb4'å·²é¢„è®¢',_utf8mb4'å·²å–æ¶ˆ')) and (`payment_time` is null)) or ((`status` in (_utf8mb4'å·²æ”¯ä»˜',_utf8mb4'å·²ä½¿ç”¨')) and (`payment_time` is not null))))
) ENGINE=InnoDB AUTO_INCREMENT=6 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='æœºç¥¨ä¿¡æ¯è¡¨'
```

### Table: ticket_status_log (çŠ¶æ€å˜æ›´æ—¥å¿—)
```sql
TABLE `ticket_status_log` (
  `log_id` int NOT NULL AUTO_INCREMENT,
  `ticket_id` bigint NOT NULL,
  `old_status` enum('å·²é¢„è®¢','å·²æ”¯ä»˜','å·²å–æ¶ˆ','å·²ä½¿ç”¨') DEFAULT NULL,
  `new_status` enum('å·²é¢„è®¢','å·²æ”¯ä»˜','å·²å–æ¶ˆ','å·²ä½¿ç”¨') DEFAULT NULL,
  `change_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  `changed_by` varchar(50) DEFAULT NULL,
  PRIMARY KEY (`log_id`),
  KEY `FKb570eyncqo03d5877ldyw0hi0` (`ticket_id`),
  CONSTRAINT `FKb570eyncqo03d5877ldyw0hi0` FOREIGN KEY (`ticket_id`) REFERENCES `tickets` (`ticket_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci
```

---

## â“ å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ

åœ¨æœ¬é¡¹ç›®å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæ€»ç»“äº†ä»¥ä¸‹å…³é”®é—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼Œä¾›å‚è€ƒï¼š

### 1. åç«¯æŠ¥ `NullPointerException` (ä¾èµ–æ³¨å…¥å¤±è´¥)
*   **ç°è±¡**: è°ƒç”¨ Controller æˆ– Service æ–¹æ³•æ—¶ï¼ŒRepository æˆ– Service å¯¹è±¡ä¸º nullã€‚
*   **åŸå› **: VS Code çš„ Java æ’ä»¶æœ‰æ—¶æ— æ³•æ­£ç¡®å¤„ç† Lombok çš„ `@RequiredArgsConstructor` æ³¨è§£ï¼Œå¯¼è‡´æ„é€ å‡½æ•°æœªç”Ÿæˆï¼Œä¾èµ–æœªæ³¨å…¥ã€‚
*   **è§£å†³**: 
    1. æ”¾å¼ƒ Lombok è‡ªåŠ¨ç”Ÿæˆï¼Œ**æ‰‹åŠ¨ç¼–å†™æ„é€ å‡½æ•°**è¿›è¡Œæ³¨å…¥ã€‚
    2. æˆ–è€…ä½¿ç”¨ `@Autowired` å­—æ®µæ³¨å…¥ï¼ˆå¦‚æœ¬é¡¹ç›®æœ€ç»ˆé‡‡ç”¨æ–¹æ¡ˆï¼‰ã€‚
    3. è¿è¡Œ `mvn clean` å¼ºåˆ¶æ¸…ç†ç¼“å­˜ã€‚

### 2. å‰ç«¯ `npm run serve` æŠ¥é”™ `async-validator`
*   **ç°è±¡**: `Module not found: Error: Can't resolve 'babel-runtime/helpers/extends'`ã€‚
*   **åŸå› **: Element UI ä¾èµ–æ—§ç‰ˆ `babel-runtime`ï¼Œè€Œ Vue CLI é¡¹ç›®é»˜è®¤ä½¿ç”¨æ–°ç‰ˆ `@babel/runtime`ã€‚
*   **è§£å†³**: åœ¨ `vue.config.js` ä¸­é…ç½®åˆ«åæ˜ å°„ï¼š
    ```javascript
    configureWebpack: {
      resolve: {
        alias: { 'babel-runtime': '@babel/runtime' }
      }
    }
    ```
    å¹¶åˆ é™¤ `node_modules/.cache` æ–‡ä»¶å¤¹åé‡å¯ã€‚

### 3. åç«¯ç«¯å£å ç”¨ (55880 / 8080)
*   **ç°è±¡**: `Port already in use` æˆ– `BindException`ã€‚
*   **è§£å†³**: 
    - ç®€å•æ–¹æ³•ï¼šé‡å¯ VS Codeã€‚
    - å‘½ä»¤è¡ŒæŸ¥æ€ï¼š`netstat -ano | findstr :ç«¯å£å·` ç„¶å `taskkill /PID <è¿›ç¨‹ID> /F`ã€‚

### 4. æ•°æ®åº“è¿æ¥æŠ¥é”™ `Access denied`
*   **åŸå› **: `application.properties` ä¸­ä½¿ç”¨äº†å ä½ç¬¦ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ã€‚
*   **è§£å†³**: ç¡®ä¿é…ç½®ä¸ºæœ¬åœ° MySQL çš„çœŸå® root è´¦å·å’Œå¯†ç ã€‚

---

<div align="center">
  <sub>Designed by AndyXuPrime | è¯¾ç¨‹è®¾è®¡ |Course Design 2024</sub>
</div>
