{"ast":null,"code":"import axios from 'axios';\nimport { Message } from 'element-ui';\nimport { store, mutations } from '@/store';\nconst apiClient = axios.create({\n  baseURL: process.env.VUE_APP_API_BASE_URL || 'http://localhost:8080',\n  timeout: 10000\n});\napiClient.interceptors.request.use(config => {\n  const token = localStorage.getItem('authToken');\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  return config;\n}, error => {\n  console.error('Request Interceptor Error:', error);\n  return Promise.reject(error);\n});\napiClient.interceptors.response.use(response => {\n  const res = response.data;\n  if (res.code !== 200) {\n    Message({\n      message: res.message || '操作失败',\n      type: 'error',\n      duration: 5 * 1000\n    });\n    return Promise.reject(new Error(res.message || 'Error'));\n  } else {\n    return res;\n  }\n}, error => {\n  console.error('Response Interceptor Error:', error.response);\n  if (error.response) {\n    switch (error.response.status) {\n      case 401:\n      case 403:\n        if (store.showLoginModal === false) {\n          Message.error('登录已过期或无权限，请重新登录');\n          mutations.clearUser();\n          mutations.setShowLoginModal(true);\n        }\n        break;\n      case 500:\n        {\n          const errorMessage = error.response.data?.message || '服务器内部错误，请联系管理员';\n          Message.error(errorMessage);\n          break;\n        }\n      default:\n        Message.error(`请求错误，状态码: ${error.response.status}`);\n    }\n  } else if (error.request) {\n    Message.error('网络连接失败，请检查您的网络设置');\n  } else {\n    Message.error('发生未知错误，请稍后重试');\n  }\n  return Promise.reject(error);\n});\nexport default {\n  login(credentials) {\n    return apiClient.post('/api/auth/login', credentials, {\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    });\n  },\n  register(userData) {\n    return apiClient.post('/api/auth/register', userData, {\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    });\n  },\n  createBooking(bookingData) {\n    return apiClient.post('/api/bookings', bookingData, {\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    });\n  },\n  refundTicket(ticketId) {\n    return apiClient.post(`/api/bookings/tickets/${ticketId}/refund`, null, {\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    });\n  },\n  searchFlights(params) {\n    return apiClient.get('/api/flights/search', {\n      params\n    });\n  },\n  getAllFlights(date) {\n    return apiClient.get('/api/flights/all', {\n      params: {\n        flightDate: date\n      }\n    });\n  },\n  getFlightStatus(flightNumber) {\n    return apiClient.get('/api/flights/status', {\n      params: {\n        flightNumber\n      }\n    });\n  },\n  getMyOrders() {\n    return apiClient.get('/api/bookings/my-tickets');\n  }\n};","map":{"version":3,"names":["axios","Message","store","mutations","apiClient","create","baseURL","process","env","VUE_APP_API_BASE_URL","timeout","interceptors","request","use","config","token","localStorage","getItem","headers","Authorization","error","console","Promise","reject","response","res","data","code","message","type","duration","Error","status","showLoginModal","clearUser","setShowLoginModal","errorMessage","login","credentials","post","register","userData","createBooking","bookingData","refundTicket","ticketId","searchFlights","params","get","getAllFlights","date","flightDate","getFlightStatus","flightNumber","getMyOrders"],"sources":["D:/LearnSomeComputerPrograms VSCode/AndyJava/PlaneTickets_courseDesign-main/frontend/src/api/index.js"],"sourcesContent":["import axios from 'axios';\nimport { Message } from 'element-ui';\nimport { store, mutations } from '@/store';\n\n\nconst apiClient = axios.create({\n    baseURL: process.env.VUE_APP_API_BASE_URL || 'http://localhost:8080',\n    timeout: 10000,\n});\n\n\napiClient.interceptors.request.use(\n    config => {\n        const token = localStorage.getItem('authToken');\n        if (token) {\n            config.headers.Authorization = `Bearer ${token}`;\n        }\n        return config;\n    },\n    error => {\n        console.error('Request Interceptor Error:', error);\n        return Promise.reject(error);\n    }\n);\n\n\napiClient.interceptors.response.use(\n    response => {\n        const res = response.data;\n        if (res.code !== 200) {\n            Message({\n                message: res.message || '操作失败',\n                type: 'error',\n                duration: 5 * 1000\n            });\n            return Promise.reject(new Error(res.message || 'Error'));\n        } else {\n            return res;\n        }\n    },\n    error => {\n        console.error('Response Interceptor Error:', error.response);\n        if (error.response) {\n            switch (error.response.status) {\n                case 401:\n                case 403:\n                    if (store.showLoginModal === false) {\n                        Message.error('登录已过期或无权限，请重新登录');\n                        mutations.clearUser();\n                        mutations.setShowLoginModal(true);\n                    }\n                    break;\n                case 500: {\n                    const errorMessage = error.response.data?.message || '服务器内部错误，请联系管理员';\n                    Message.error(errorMessage);\n                    break;\n                }\n\n                default:\n                    Message.error(`请求错误，状态码: ${error.response.status}`);\n            }\n        } else if (error.request) {\n            Message.error('网络连接失败，请检查您的网络设置');\n        } else {\n            Message.error('发生未知错误，请稍后重试');\n        }\n        return Promise.reject(error);\n    }\n);\n\n\n\nexport default {\n\n    login(credentials) {\n        return apiClient.post('/api/auth/login', credentials, {\n            headers: {\n                'Content-Type': 'application/json'\n            }\n        });\n    },\n\n\n    register(userData) {\n        return apiClient.post('/api/auth/register', userData, {\n            headers: {\n                'Content-Type': 'application/json'\n            }\n        });\n    },\n\n\n    createBooking(bookingData) {\n        return apiClient.post('/api/bookings', bookingData, {\n            headers: {\n                'Content-Type': 'application/json'\n            }\n        });\n    },\n\n\n    refundTicket(ticketId) {\n        return apiClient.post(`/api/bookings/tickets/${ticketId}/refund`, null, {\n            headers: {\n                'Content-Type': 'application/json'\n            }\n        });\n    },\n\n\n    searchFlights(params) {\n        return apiClient.get('/api/flights/search', { params });\n    },\n\n    getAllFlights(date) {\n        return apiClient.get('/api/flights/all', { params: { flightDate: date } });\n    },\n\n    getFlightStatus(flightNumber) {\n        return apiClient.get('/api/flights/status', { params: { flightNumber } });\n    },\n\n    getMyOrders() {\n        return apiClient.get('/api/bookings/my-tickets');\n    },\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}