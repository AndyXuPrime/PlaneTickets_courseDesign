{"ast":null,"code":"import FlightSearchForm from '../components/FlightSearchForm.vue';\nimport AirlineSearchForm from '../components/AirlineSearchForm.vue';\nimport FlightList from '../components/FlightList.vue';\nimport api from '../api';\nexport default {\n  name: 'HomeView',\n  components: {\n    FlightSearchForm,\n    AirlineSearchForm,\n    FlightList\n  },\n  data() {\n    return {\n      searchMode: 'byRoute',\n      isLoading: false,\n      flights: [],\n      lastSearchParams: null,\n      isInitialLoad: true\n    };\n  },\n  computed: {\n    resultTitle() {\n      return this.isInitialLoad ? '今日推荐航班' : '查询结果';\n    },\n    displayDate() {\n      return this.lastSearchParams?.flightDate || new Date().toISOString().split('T')[0];\n    },\n    searchSummary() {\n      if (!this.lastSearchParams) return `日期: ${this.displayDate}`;\n      if (this.lastSearchParams.searchType === 'byRoute') {\n        const [dep, arr] = this.lastSearchParams.value.split('-');\n        return `${dep} → ${arr} (${this.lastSearchParams.flightDate})`;\n      }\n      if (this.lastSearchParams.searchType === 'byAirline') {\n        return `航空公司: ${this.lastSearchParams.value} (${this.lastSearchParams.flightDate})`;\n      }\n      return '';\n    }\n  },\n  created() {\n    this.loadInitialFlights();\n  },\n  methods: {\n    async loadInitialFlights() {\n      this.isLoading = true;\n      this.isInitialLoad = true;\n      this.lastSearchParams = null;\n      const today = new Date().toISOString().split('T')[0];\n      try {\n        const response = await api.getAllFlights(today);\n        this.flights = response.data;\n      } catch (error) {\n        console.error(\"加载初始航班失败:\", error);\n      } finally {\n        this.isLoading = false;\n      }\n    },\n    async handleSearch(searchParams) {\n      this.isLoading = true;\n      this.isInitialLoad = false;\n      this.flights = [];\n      let apiParams;\n      if (searchParams.departureAirport) {\n        apiParams = {\n          searchType: 'byRoute',\n          value: `${searchParams.departureAirport}-${searchParams.arrivalAirport}`,\n          flightDate: searchParams.flightDate\n        };\n      } else {\n        apiParams = {\n          searchType: 'byAirline',\n          value: searchParams.airlineCode,\n          flightDate: searchParams.flightDate\n        };\n      }\n      this.lastSearchParams = apiParams;\n      try {\n        const response = await api.searchFlights(apiParams);\n        this.flights = response.data;\n      } catch (error) {\n        console.error(\"航班搜索失败:\", error);\n      } finally {\n        this.isLoading = false;\n      }\n    }\n  }\n};","map":{"version":3,"names":["FlightSearchForm","AirlineSearchForm","FlightList","api","name","components","data","searchMode","isLoading","flights","lastSearchParams","isInitialLoad","computed","resultTitle","displayDate","flightDate","Date","toISOString","split","searchSummary","searchType","dep","arr","value","created","loadInitialFlights","methods","today","response","getAllFlights","error","console","handleSearch","searchParams","apiParams","departureAirport","arrivalAirport","airlineCode","searchFlights"],"sources":["src/views/HomeView.vue"],"sourcesContent":["<template>\n  <div>\n    <!-- 卡片1: 航班搜索表单 -->\n    <div class=\"card search-section\">\n      <div class=\"card-body\" style=\"padding: 0;\">\n        <!-- 搜索模式切换 -->\n        <el-tabs v-model=\"searchMode\" type=\"card\" class=\"search-mode-tabs\">\n          <el-tab-pane label=\"按航线查询\" name=\"byRoute\"></el-tab-pane>\n          <el-tab-pane label=\"按航空公司查询\" name=\"byAirline\"></el-tab-pane>\n        </el-tabs>\n        <div class=\"search-form-container\">\n          <flight-search-form \n            v-if=\"searchMode === 'byRoute'\"\n            @search=\"handleSearch\" \n            :is-loading=\"isLoading\" \n          />\n          <airline-search-form \n            v-if=\"searchMode === 'byAirline'\"\n            @search=\"handleSearch\" \n            :is-loading=\"isLoading\" \n          />\n        </div>\n      </div>\n    </div>\n\n    <!-- 卡片2: 航班结果展示 -->\n    <div class=\"card\">\n      <div class=\"card-header\">\n        <h3 class=\"card-title\">{{ resultTitle }}</h3>\n        <span v-if=\"lastSearchParams\" class=\"text-muted\">{{ searchSummary }}</span>\n      </div>\n      <div class=\"card-body\">\n        <div v-if=\"isLoading\" class=\"loading-state\">\n          <i class=\"el-icon-loading\"></i><p>正在加载航班信息...</p>\n        </div>\n        <div v-else-if=\"!flights.length\" class=\"no-results-state\">\n          <i class=\"el-icon-info\"></i><p>抱歉，未找到符合条件的航班。</p>\n        </div>\n        <!-- 无论默认加载还是搜索结果，都使用 FlightList 组件展示 -->\n        <flight-list v-else :flights=\"flights\" :search-date=\"displayDate\" />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport FlightSearchForm from '../components/FlightSearchForm.vue';\nimport AirlineSearchForm from '../components/AirlineSearchForm.vue';\nimport FlightList from '../components/FlightList.vue';\nimport api from '../api';\n\nexport default {\n  name: 'HomeView',\n  components: { FlightSearchForm, AirlineSearchForm, FlightList },\n  data() {\n    return {\n      searchMode: 'byRoute',\n      isLoading: false,\n      flights: [],\n      lastSearchParams: null, \n      isInitialLoad: true, \n    };\n  },\n  computed: {\n    \n    resultTitle() {\n      return this.isInitialLoad ? '今日推荐航班' : '查询结果';\n    },\n    \n    displayDate() {\n      return this.lastSearchParams?.flightDate || new Date().toISOString().split('T')[0];\n    },\n    \n    searchSummary() {\n      if (!this.lastSearchParams) return `日期: ${this.displayDate}`;\n      if (this.lastSearchParams.searchType === 'byRoute') {\n        const [dep, arr] = this.lastSearchParams.value.split('-');\n        return `${dep} → ${arr} (${this.lastSearchParams.flightDate})`;\n      }\n      if (this.lastSearchParams.searchType === 'byAirline') {\n        return `航空公司: ${this.lastSearchParams.value} (${this.lastSearchParams.flightDate})`;\n      }\n      return '';\n    }\n  },\n  created() {\n    \n    this.loadInitialFlights();\n  },\n  methods: {\n    \n    async loadInitialFlights() {\n      this.isLoading = true;\n      this.isInitialLoad = true;\n      this.lastSearchParams = null;\n      const today = new Date().toISOString().split('T')[0];\n      try {\n        const response = await api.getAllFlights(today);\n        this.flights = response.data;\n      } catch (error) {\n        console.error(\"加载初始航班失败:\", error);\n      } finally {\n        this.isLoading = false;\n      }\n    },\n    \n    async handleSearch(searchParams) {\n      this.isLoading = true;\n      this.isInitialLoad = false; \n      this.flights = [];\n      \n      let apiParams;\n      if (searchParams.departureAirport) {\n        apiParams = {\n          searchType: 'byRoute',\n          value: `${searchParams.departureAirport}-${searchParams.arrivalAirport}`,\n          flightDate: searchParams.flightDate\n        };\n      } else {\n        apiParams = {\n          searchType: 'byAirline',\n          value: searchParams.airlineCode,\n          flightDate: searchParams.flightDate\n        };\n      }\n      this.lastSearchParams = apiParams;\n\n      try {\n        const response = await api.searchFlights(apiParams);\n        this.flights = response.data;\n      } catch (error) {\n        console.error(\"航班搜索失败:\", error);\n      } finally {\n        this.isLoading = false;\n      }\n    },\n  },\n};\n</script>\n\n<style scoped>\n.loading-state, .no-results-state {\n  text-align: center;\n  padding: 40px 20px;\n  color: var(--gray);\n}\n.loading-state .el-icon-loading, .no-results-state .el-icon-info {\n  font-size: 48px;\n  margin-bottom: 20px;\n}\n.no-results-state span {\n  font-size: 14px;\n}\n.text-muted {\n  color: var(--gray);\n  font-size: 14px;\n}\n</style>"],"mappings":"AA8CA,OAAAA,gBAAA;AACA,OAAAC,iBAAA;AACA,OAAAC,UAAA;AACA,OAAAC,GAAA;AAEA;EACAC,IAAA;EACAC,UAAA;IAAAL,gBAAA;IAAAC,iBAAA;IAAAC;EAAA;EACAI,KAAA;IACA;MACAC,UAAA;MACAC,SAAA;MACAC,OAAA;MACAC,gBAAA;MACAC,aAAA;IACA;EACA;EACAC,QAAA;IAEAC,YAAA;MACA,YAAAF,aAAA;IACA;IAEAG,YAAA;MACA,YAAAJ,gBAAA,EAAAK,UAAA,QAAAC,IAAA,GAAAC,WAAA,GAAAC,KAAA;IACA;IAEAC,cAAA;MACA,UAAAT,gBAAA,qBAAAI,WAAA;MACA,SAAAJ,gBAAA,CAAAU,UAAA;QACA,OAAAC,GAAA,EAAAC,GAAA,SAAAZ,gBAAA,CAAAa,KAAA,CAAAL,KAAA;QACA,UAAAG,GAAA,MAAAC,GAAA,UAAAZ,gBAAA,CAAAK,UAAA;MACA;MACA,SAAAL,gBAAA,CAAAU,UAAA;QACA,qBAAAV,gBAAA,CAAAa,KAAA,UAAAb,gBAAA,CAAAK,UAAA;MACA;MACA;IACA;EACA;EACAS,QAAA;IAEA,KAAAC,kBAAA;EACA;EACAC,OAAA;IAEA,MAAAD,mBAAA;MACA,KAAAjB,SAAA;MACA,KAAAG,aAAA;MACA,KAAAD,gBAAA;MACA,MAAAiB,KAAA,OAAAX,IAAA,GAAAC,WAAA,GAAAC,KAAA;MACA;QACA,MAAAU,QAAA,SAAAzB,GAAA,CAAA0B,aAAA,CAAAF,KAAA;QACA,KAAAlB,OAAA,GAAAmB,QAAA,CAAAtB,IAAA;MACA,SAAAwB,KAAA;QACAC,OAAA,CAAAD,KAAA,cAAAA,KAAA;MACA;QACA,KAAAtB,SAAA;MACA;IACA;IAEA,MAAAwB,aAAAC,YAAA;MACA,KAAAzB,SAAA;MACA,KAAAG,aAAA;MACA,KAAAF,OAAA;MAEA,IAAAyB,SAAA;MACA,IAAAD,YAAA,CAAAE,gBAAA;QACAD,SAAA;UACAd,UAAA;UACAG,KAAA,KAAAU,YAAA,CAAAE,gBAAA,IAAAF,YAAA,CAAAG,cAAA;UACArB,UAAA,EAAAkB,YAAA,CAAAlB;QACA;MACA;QACAmB,SAAA;UACAd,UAAA;UACAG,KAAA,EAAAU,YAAA,CAAAI,WAAA;UACAtB,UAAA,EAAAkB,YAAA,CAAAlB;QACA;MACA;MACA,KAAAL,gBAAA,GAAAwB,SAAA;MAEA;QACA,MAAAN,QAAA,SAAAzB,GAAA,CAAAmC,aAAA,CAAAJ,SAAA;QACA,KAAAzB,OAAA,GAAAmB,QAAA,CAAAtB,IAAA;MACA,SAAAwB,KAAA;QACAC,OAAA,CAAAD,KAAA,YAAAA,KAAA;MACA;QACA,KAAAtB,SAAA;MACA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}