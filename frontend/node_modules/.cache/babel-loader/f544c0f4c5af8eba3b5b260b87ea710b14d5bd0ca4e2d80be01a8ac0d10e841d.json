{"ast":null,"code":"// 引入所有需要的API\nimport api from '../api';\nexport default {\n  name: 'AdminView',\n  data() {\n    return {\n      activeTab: 'flight-management',\n      loading: false,\n      loadingStats: false,\n      flights: [],\n      dialogVisible: false,\n      dialogTitle: '',\n      flightForm: {},\n      // 用于新增/编辑的表单数据\n\n      // 统计相关\n      salesDateRange: [],\n      salesAnalysis: {},\n      reportDimension: 'airline',\n      genericReportData: []\n    };\n  },\n  created() {\n    this.fetchFlights();\n  },\n  methods: {\n    // --- 航班管理 ---\n    async fetchFlights() {\n      this.loading = true;\n      try {\n        const response = await api.admin.getAllFlights(); // 假设api已按模块组织\n        this.flights = response.data;\n      } finally {\n        this.loading = false;\n      }\n    },\n    openFlightDialog(flight = null) {\n      if (flight) {\n        this.dialogTitle = '编辑航班';\n        this.flightForm = {\n          ...flight\n        };\n      } else {\n        this.dialogTitle = '新增航班';\n        this.flightForm = {}; // 清空表单\n      }\n      this.dialogVisible = true;\n    },\n    async saveFlight() {\n      // ... 表单校验 ...\n      try {\n        if (this.flightForm.flightNumber) {\n          // 编辑\n          await api.admin.updateFlight(this.flightForm.flightNumber, this.flightForm);\n        } else {\n          // 新增\n          await api.admin.createFlight(this.flightForm);\n        }\n        this.$message.success('保存成功');\n        this.dialogVisible = false;\n        this.fetchFlights(); // 刷新列表\n      } catch (error) {\n        // 错误已由拦截器处理\n      }\n    },\n    async deleteFlight(flightNumber) {\n      await this.$confirm('此操作将永久删除该航班, 是否继续?', '提示');\n      await api.admin.deleteFlight(flightNumber);\n      this.$message.success('删除成功');\n      this.fetchFlights();\n    },\n    // --- 统计报表 ---\n    async fetchRouteSales() {},\n    async fetchGenericReport() {}\n  }\n};","map":{"version":3,"names":["api","name","data","activeTab","loading","loadingStats","flights","dialogVisible","dialogTitle","flightForm","salesDateRange","salesAnalysis","reportDimension","genericReportData","created","fetchFlights","methods","response","admin","getAllFlights","openFlightDialog","flight","saveFlight","flightNumber","updateFlight","createFlight","$message","success","error","deleteFlight","$confirm","fetchRouteSales","fetchGenericReport"],"sources":["src/views/AdminView.vue"],"sourcesContent":["<template>\n  <div class=\"admin-page\">\n    <h1>后台管理面板</h1>\n    \n    <el-tabs v-model=\"activeTab\" type=\"border-card\">\n      <!-- 航班管理 Tab -->\n      <el-tab-pane label=\"航班管理\" name=\"flight-management\">\n        <div class=\"toolbar\">\n          <el-button type=\"primary\" icon=\"el-icon-plus\" @click=\"openFlightDialog()\">新增航班</el-button>\n        </div>\n        <el-table :data=\"flights\" stripe v-loading=\"loading\">\n          <el-table-column prop=\"flightNumber\" label=\"航班号\"></el-table-column>\n          <el-table-column prop=\"airlineName\" label=\"航空公司\"></el-table-column>\n          <el-table-column prop=\"departureAirport\" label=\"出发地\"></el-table-column>\n          <el-table-column prop=\"arrivalAirport\" label=\"目的地\"></el-table-column>\n          <el-table-column prop=\"basePrice\" label=\"基础票价\"></el-table-column>\n          <el-table-column label=\"操作\">\n            <template slot-scope=\"scope\">\n              <el-button size=\"mini\" @click=\"openFlightDialog(scope.row)\">编辑</el-button>\n              <el-button size=\"mini\" type=\"danger\" @click=\"deleteFlight(scope.row.flightNumber)\">删除</el-button>\n            </template>\n          </el-table-column>\n        </el-table>\n      </el-tab-pane>\n\n      <!-- 统计报表 Tab -->\n      <el-tab-pane label=\"统计报表\" name=\"statistics\">\n        <!-- 航线销售分析 -->\n        <el-card class=\"box-card\">\n          <div slot=\"header\"><span>航线销售分析</span></div>\n          <el-date-picker v-model=\"salesDateRange\" type=\"daterange\" range-separator=\"至\" start-placeholder=\"开始日期\" end-placeholder=\"结束日期\"></el-date-picker>\n          <el-button @click=\"fetchRouteSales\" :loading=\"loadingStats\">查询</el-button>\n          <p v-if=\"salesAnalysis.suggestion\"><b>打折策略建议:</b> {{ salesAnalysis.suggestion }}</p>\n          <el-table :data=\"salesAnalysis.data\" stripe v-loading=\"loadingStats\">\n            <el-table-column prop=\"departureAirport\" label=\"出发地\"></el-table-column>\n            <el-table-column prop=\"arrivalAirport\" label=\"目的地\"></el-table-column>\n            <el-table-column prop=\"ticketCount\" label=\"售出票数\"></el-table-column>\n            <el-table-column prop=\"totalRevenue\" label=\"总销售额\"></el-table-column>\n          </el-table>\n        </el-card>\n        <!-- 其他统计报表 -->\n        <el-card class=\"box-card\">\n          <div slot=\"header\"><span>分类统计</span></div>\n          <el-select v-model=\"reportDimension\" placeholder=\"选择统计维度\">\n            <el-option label=\"按航空公司\" value=\"airline\"></el-option>\n            <el-option label=\"按机型\" value=\"aircraftmodel\"></el-option>\n            <el-option label=\"按热门航线\" value=\"route\"></el-option>\n          </el-select>\n          <el-button @click=\"fetchGenericReport\" :loading=\"loadingStats\">查询</el-button>\n          <el-table :data=\"genericReportData\" stripe v-loading=\"loadingStats\">\n            <el-table-column prop=\"dimension\" label=\"维度\"></el-table-column>\n            <el-table-column prop=\"count\" label=\"票量\"></el-table-column>\n          </el-table>\n        </el-card>\n      </el-tab-pane>\n    </el-tabs>\n\n    <!-- 新增/编辑航班的对话框 -->\n    <el-dialog :title=\"dialogTitle\" :visible.sync=\"dialogVisible\">\n      <el-form :model=\"flightForm\" ref=\"flightForm\" label-width=\"100px\">\n        <!-- 表单项... -->\n      </el-form>\n      <div slot=\"footer\">\n        <el-button @click=\"dialogVisible = false\">取消</el-button>\n        <el-button type=\"primary\" @click=\"saveFlight\">保存</el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\n// 引入所有需要的API\nimport api from '../api'; \n\nexport default {\n  name: 'AdminView',\n  data() {\n    return {\n      activeTab: 'flight-management',\n      loading: false,\n      loadingStats: false,\n      flights: [],\n      dialogVisible: false,\n      dialogTitle: '',\n      flightForm: {}, // 用于新增/编辑的表单数据\n      \n      // 统计相关\n      salesDateRange: [],\n      salesAnalysis: {},\n      reportDimension: 'airline',\n      genericReportData: [],\n    };\n  },\n  created() {\n    this.fetchFlights();\n  },\n  methods: {\n    // --- 航班管理 ---\n    async fetchFlights() {\n      this.loading = true;\n      try {\n        const response = await api.admin.getAllFlights(); // 假设api已按模块组织\n        this.flights = response.data;\n      } finally {\n        this.loading = false;\n      }\n    },\n    openFlightDialog(flight = null) {\n      if (flight) {\n        this.dialogTitle = '编辑航班';\n        this.flightForm = { ...flight };\n      } else {\n        this.dialogTitle = '新增航班';\n        this.flightForm = {}; // 清空表单\n      }\n      this.dialogVisible = true;\n    },\n    async saveFlight() {\n      // ... 表单校验 ...\n      try {\n        if (this.flightForm.flightNumber) { // 编辑\n          await api.admin.updateFlight(this.flightForm.flightNumber, this.flightForm);\n        } else { // 新增\n          await api.admin.createFlight(this.flightForm);\n        }\n        this.$message.success('保存成功');\n        this.dialogVisible = false;\n        this.fetchFlights(); // 刷新列表\n      } catch (error) {\n        // 错误已由拦截器处理\n      }\n    },\n    async deleteFlight(flightNumber) {\n      await this.$confirm('此操作将永久删除该航班, 是否继续?', '提示');\n      await api.admin.deleteFlight(flightNumber);\n      this.$message.success('删除成功');\n      this.fetchFlights();\n    },\n\n    // --- 统计报表 ---\n    async fetchRouteSales() {\n        \n    },\n    async fetchGenericReport() {\n        \n    }\n  }\n};\n</script>\n\n<style scoped>\n.admin-page { padding: 20px; }\n.toolbar { margin-bottom: 20px; }\n.box-card { margin-top: 20px; }\n</style>"],"mappings":"AAuEA;AACA,OAAAA,GAAA;AAEA;EACAC,IAAA;EACAC,KAAA;IACA;MACAC,SAAA;MACAC,OAAA;MACAC,YAAA;MACAC,OAAA;MACAC,aAAA;MACAC,WAAA;MACAC,UAAA;MAAA;;MAEA;MACAC,cAAA;MACAC,aAAA;MACAC,eAAA;MACAC,iBAAA;IACA;EACA;EACAC,QAAA;IACA,KAAAC,YAAA;EACA;EACAC,OAAA;IACA;IACA,MAAAD,aAAA;MACA,KAAAX,OAAA;MACA;QACA,MAAAa,QAAA,SAAAjB,GAAA,CAAAkB,KAAA,CAAAC,aAAA;QACA,KAAAb,OAAA,GAAAW,QAAA,CAAAf,IAAA;MACA;QACA,KAAAE,OAAA;MACA;IACA;IACAgB,iBAAAC,MAAA;MACA,IAAAA,MAAA;QACA,KAAAb,WAAA;QACA,KAAAC,UAAA;UAAA,GAAAY;QAAA;MACA;QACA,KAAAb,WAAA;QACA,KAAAC,UAAA;MACA;MACA,KAAAF,aAAA;IACA;IACA,MAAAe,WAAA;MACA;MACA;QACA,SAAAb,UAAA,CAAAc,YAAA;UAAA;UACA,MAAAvB,GAAA,CAAAkB,KAAA,CAAAM,YAAA,MAAAf,UAAA,CAAAc,YAAA,OAAAd,UAAA;QACA;UAAA;UACA,MAAAT,GAAA,CAAAkB,KAAA,CAAAO,YAAA,MAAAhB,UAAA;QACA;QACA,KAAAiB,QAAA,CAAAC,OAAA;QACA,KAAApB,aAAA;QACA,KAAAQ,YAAA;MACA,SAAAa,KAAA;QACA;MAAA;IAEA;IACA,MAAAC,aAAAN,YAAA;MACA,WAAAO,QAAA;MACA,MAAA9B,GAAA,CAAAkB,KAAA,CAAAW,YAAA,CAAAN,YAAA;MACA,KAAAG,QAAA,CAAAC,OAAA;MACA,KAAAZ,YAAA;IACA;IAEA;IACA,MAAAgB,gBAAA,GAEA;IACA,MAAAC,mBAAA,GAEA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}